<!--Authors: John Gabriel Pampo, Justine Lucas-->>
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>GoGora - Ride Management</title>
  <link rel="stylesheet" href="admin.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Markazi+Text:wght@400..700&display=swap" rel="stylesheet">
  <script src="/api/rides.js" defer></script>

  <style>
    .title-section {
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .rides-section, .schedules-section {
      margin-top: 20px;
    }

    .ride-item, .schedule-item {
      border: 1px solid #ddd;
      padding: 10px;
      margin: 10px 0;
      border-radius: 5px;
      background-color: #f9f9f9;
    }
  </style>
</head>
<body>
  <div class="dashboard">
    <aside class="sidebar">
      <div class="logo">
        <h2><span style="color: #4285F4;">Go</span><span style="color: #FBBC05;">Go</span><span style="color: #FBBC05;">Ra</span></h2>
      </div>
      <nav>
        <ul class="menu">
          <li><a href="index.html" class="menu-item"><i class="icon">🏠</i> Dashboard</a></li>
          <li><a href="ride_manager.html" class="menu-item"><i class="icon">🛣️</i> Manage Rides</a></li>
          <li><a href="account_manager.html" class="menu-item"><i class="icon">👥</i> Manage Accounts</a></li>
          <li><a href="statistics.html" class="menu-item"><i class="icon">📊</i> Statistics</a></li>
          <li><a href="blacklist.html" class="menu-item"><i class="icon">🚫</i> Blacklist Passengers</a></li>
        </ul>
      </nav>
    </aside>
    <main class="main-content">
      <!-- RideAVs Section -->
      <div class="title-section">
        <h1>Manage Rides</h1>
        <button class="add-ride" onclick="location.href='ride.html'">Edit Rides</button>
      </div>
      <div class="rides-section">
        <h2>Rides</h2>
        <div id="rides-container">
          <!-- Ride items will be dynamically loaded here -->
        </div>
      </div>
      <!-- Schedules Section -->
      <div class="title-section">
        <h1>Manage Schedules</h1>
        <button class="add-schedule" onclick="location.href='schedules.html'">Edit Schedules</button>
      </div>
      <div class="schedules-section">
        <h2>Schedules</h2>
        <div id="schedules-container">

        </div>
      </div>
    </main>
  </div>
  <script>
    // Function to fetch and display ride data
    async function fetchData() {
      try {
        // Fetch data from the server's API endpoint
        const ridesResponse = await fetch('/api/rides'); // Make request to the backend
        if (!ridesResponse.ok) {
          throw new Error('Failed to fetch rides');
        }
        const rides = await ridesResponse.json(); // Parse JSON response
        const ridesContainer = document.getElementById('rides-container');
        ridesContainer.innerHTML = ''; // Clear the container before adding new data

        // Loop through the rides data and display each ride
        rides.forEach(ride => {
          const rideItem = document.createElement('div');
          rideItem.className = 'ride-item';
          rideItem.innerHTML = `
            <p>Ride ID: ${ride.ride_id}</p>
            <p>Plate Number: ${ride.plate_number}</p>
            <p>Driver: ${ride.driver || 'N/A'}</p>
            <p>Route: ${ride.route}</p>
            <p>Departure: ${new Date(ride.departure).toLocaleString()}</p>
            <p>Seats Available: ${ride.seats_available}</p>
          `;
          ridesContainer.appendChild(rideItem);
        });
      } catch (error) {
        console.error('Error fetching data:', error);
        document.getElementById('rides-container').innerHTML = `<p>Failed to load rides data.</p>`;
      }
    }

    // Call the fetchData function to load the data when the page loads
    fetchData();
  </script>
  
  
</body>
</html>