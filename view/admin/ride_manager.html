<!--Authors: John Gabriel Pampo, Justine Lucas-->>
<!-- ride_manager.html -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>GoGora - Ride Management</title>
  <link rel="stylesheet" href="admin.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Markazi+Text:wght@400..700&display=swap" rel="stylesheet">  
  <script src="script.js" defer></script>
</head>
<body>
  <div class="dashboard">
    <aside class="sidebar">
      <div class="logo">
        <h2><span style="color: #4285F4;">Go</span><span style="color: #FBBC05;">Go</span><span style="color: #FBBC05;">Ra</span></h2>
      </div>
      <nav>
        <ul class="menu">
          <li><a href="index.html" class="menu-item"><i class="icon">üè†</i> Dashboard</a></li>
          <li><a href="ride_manager.html" class="menu-item"><i class="icon">üöñ</i> Manage Rides</a></li>
          <li><a href="account_manager.html" class="menu-item"><i class="icon">üìÖ</i> Manage Accounts</a></li>
          <li><a href="statistics.html" class="menu-item"><i class="icon">üìä</i> Statistics</a></li>
          <li><a href="blacklist.html" class="menu-item"><i class="icon">üö´</i> Blacklist Passengers</a></li>
        </ul>
      </nav>
    </aside>
    <main class="main-content">
      <h1>Manage Rides</h1>
      <div class="rides-section">
        <h2>Rides</h2>
        <button class="add-ride">Add Ride</button>
        <div class="ride-item">
          <span>Ride A</span>
          <div>
            <button class="edit-ride">Edit</button>
            <button class="delete-ride">Delete</button>
          </div>
        </div>
        <div class="ride-item">
          <span>${ride.plate_number}</span>
          <img src="/uploads/${ride.image}" alt="Ride Image" width="100">
          <div>
            <button class="edit-ride">Edit</button>
            <button class="delete-ride">Delete</button>
          </div>
        </div>        
      </div>
      <div class="schedules-section">
        <h2>Schedules</h2>
        <button class="add-schedule">Add Schedule</button>
        <div class="schedule-item">
          <span>8:00 AM</span>
          <div>
            <button class="edit-schedule">Edit</button>
            <button class="delete-schedule">Delete</button>
          </div>
        </div>
        <div class="schedule-item">
          <span>9:00 AM</span>
          <div>
            <button class="edit-schedule">Edit</button>
            <button class="delete-schedule">Delete</button>
          </div>
        </div>
      </div>
    </main>
  </div>
  <div id="addRideModal" class="modal">
    <div class="modal-content">
      <h2>ADD A RIDE</h2>
      <label for="plateNumber">Plate Number</label>
      <input type="text" id="plateNumber" placeholder="Value">
      <label for="typeOfRide">Type of Ride</label>
      <select id="typeOfRide">
        <option value="jeepney">Jeepney</option>
        <option value="service">Service</option>
      </select>
      <label for="seatingCapacity">Seating Capacity</label>
      <input type="number" id="seatingCapacity" placeholder="Value">
      <label for="route">Route</label>
      <input type="text" id="route" placeholder="Value">
      <label for="schedule">Schedule</label>
      <input type="text" id="schedule" placeholder="Value">
      <label for="rideImage">Ride Image</label>
      <input type="file" id="rideImage" name="image" accept="image/*">

      <div class="button-group">
        <button id="addRideButton">ADD RIDE</button>
        <button id="closeModalButton">BACK</button>
      </div>
    </div>
  </div>
  <script>
  const addRideForm = document.getElementById('addRideForm'); // Assume your form has this ID

  addRideForm.addEventListener('submit', async (e) => {
    e.preventDefault();

    // Get form values
    const plateNumber = document.getElementById('plateNumber').value;
    const typeOfRide = document.getElementById('typeOfRide').value;
    const seatingCapacity = document.getElementById('seatingCapacity').value;
    const route = document.getElementById('route').value;
    const schedule = document.getElementById('schedule').value;

    // Prepare the data object
    const rideData = {
      plate_number: plateNumber,
      type_of_ride: typeOfRide,
      seating_capacity: seatingCapacity,
      route: route,
      schedule: schedule
    };

    try {
      const response = await fetch('/routes/rides', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify(rideData),
      });

      const result = await response.json();

      if (response.ok) {
        alert('Ride added successfully!');
        location.reload(); // Refresh the page or update the table
      } else {
        alert(`Failed to add ride: ${result.error}`);
      }
    } catch (error) {
      console.error('Error adding ride:', error);
      alert('An error occurred while adding the ride.');
    }
  });
</script>

</body>
</html>
